<!-- Modal Unificado para Crear/Editar Variante -->
<div class="modal" id="variantModal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 id="modalTitle">Nueva Variante</h3>
      <button class="modal-close" onclick="closeVariantModal()">
        <i class="fa-solid fa-times"></i>
      </button>
    </div>

    <form id="variantForm" class="admin-form">
      <input type="hidden" id="variantId">

      <div class="form-row">
        <div class="form-field">
          <label for="variantProduct">Producto</label>
          <select id="variantProduct" name="productId" required>
            <option value="">Seleccionar producto</option>
          </select>
        </div>
        <div class="form-field">
          <label for="variantType">Tipo de Variante</label>
          <select id="variantType" name="type" required>
            <option value="">Seleccionar tipo</option>
            <option value="color">Color</option>
            <option value="storage">Almacenamiento</option>
            <option value="size">Tamaño</option>
            <option value="memory">Memoria RAM</option>
            <option value="other">Otro</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-field">
          <label for="variantName">Nombre</label>
          <input type="text" id="variantName" name="name" required placeholder="Ej: Azul, 256GB, Large">
        </div>
        <div class="form-field">
          <label for="variantValue">Valor</label>
          <input type="text" id="variantValue" name="value" required placeholder="Valor técnico o código">
        </div>
      </div>

      <div class="form-row">
        <div class="form-field">
          <label for="variantPriceAdjustment">Ajuste de Precio ($)</label>
          <input type="number" id="variantPriceAdjustment" name="priceAdjustment" step="0.01" value="0">
          <small class="form-help">Positivo para incremento, negativo para descuento</small>
        </div>
        <div class="form-field">
          <label for="variantSortOrder">Orden</label>
          <input type="number" id="variantSortOrder" name="sortOrder" min="0" value="0">
          <small class="form-help">Orden de aparición (menor número = primero)</small>
        </div>
      </div>

      <!-- Color-specific fields -->
      <div id="colorFields" class="color-variant-fields" style="display: none;">
        <div class="form-field">
          <label for="variantColorHex">Color Hex</label>
          <div class="color-input-group">
            <input type="color" id="variantColorHex" name="colorHex" value="#000000">
            <input type="text" id="variantColorText" name="colorText" placeholder="#000000">
          </div>
        </div>
      </div>

      <!-- Image field -->
      <div class="form-field">
        <label for="variantImage">URL de Imagen (opcional)</label>
        <input type="url" id="variantImage" name="image" placeholder="https://ejemplo.com/imagen.jpg">
      </div>

      <div class="form-field">
        <label>Vista Previa</label>
        <div class="variant-preview" id="variantPreview">
          <div class="preview-color" id="previewColor" style="display: none;"></div>
          <div class="preview-text" id="previewText">Sin vista previa</div>
          <img id="previewImage" style="display: none;" alt="Vista previa">
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-secondary" onclick="closeVariantModal()">Cancelar</button>
        <button type="submit" class="btn btn-primary">
          <i class="fa-solid fa-save"></i> Guardar Variante
        </button>
      </div>
    </form>
  </div>
</div>

<style>
  /* Variant-specific styles */
  .color-variant-fields {
    padding: 1rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    border: 1px solid var(--border-color);
    margin: 1rem 0;
  }

  .color-input-group {
    display: flex;
    gap: 0.5rem;
    align-items: center;
  }

  .color-input-group input[type="color"] {
    width: 60px;
    height: 40px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
  }

  .color-input-group input[type="text"] {
    flex: 1;
  }

  .variant-preview {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    border: 1px solid var(--border-color);
    min-height: 60px;
  }

  .preview-color {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: 2px solid var(--border-color);
  }

  .preview-text {
    color: var(--text-color);
    font-weight: 500;
  }

  #previewImage {
    max-width: 100px;
    max-height: 60px;
    border-radius: 6px;
    border: 1px solid var(--border-color);
  }

  .form-help {
    font-size: 0.85rem;
    color: var(--text-muted-color);
    margin-top: 0.25rem;
    display: block;
  }
</style>
